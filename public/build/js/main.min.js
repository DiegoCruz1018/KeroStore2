(()=>{let t=1;const e={id:"",nombre:"",productos:[],total:""};function o(){const e=document.querySelector(".mostrar");e&&e.classList.remove("mostrar");const o="#paso-"+t;document.querySelector(o).classList.add("mostrar");const n=document.querySelector(".actual");n&&n.classList.remove("actual"),document.querySelector(`[data-paso="${t}"]`).classList.add("actual")}function n(){const t=document.querySelector(".lista-carrito");t.innerHTML="";let o=0,n=0;const{productos:c}=e,r=document.querySelector("#total-productos");c.forEach(e=>{const a=document.createElement("DIV");a.classList.add("list-products"),o+=parseInt(e.quantity*e.price.slice(1)),n+=e.quantity,a.innerHTML=`\n            <div class="carrito">\n                \x3c!-- <h1 class="carrito-titulo">Carrito de compras</h1> --\x3e\n                <div class="carrito-info">\n                    <div class="producto-info">\n                        <p class="producto-id">${e.id}</p>\n                        <h2 class="producto-nombre">${e.title}</h2>\n                        <p class="producto-precio">${e.price}</p>\n                        <div class="carrito-botones">\n                            <div class="carrito-cantidad">\n                                \x3c!-- <Button\n                                variant="outline"\n                                size="sm"\n                                class="boton-cantidad"\n                                id="boton-restar"\n                                >\n                                -\n                                </Button> --\x3e\n                                <span class="producto-cantidad">Cantidad: ${e.quantity}</span>\n                                \n                                \x3c!-- <Button class="boton-cantidad boton-sumar" id="boton-sumar">\n                                +\n                                </Button> --\x3e\n                            </div>\n                            <Button class="boton-eliminar">\n                                Eliminar\n                            </Button>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        `,t.append(a)}),document.querySelector("#total-pagar").innerText="$"+o,document.querySelector("#total-producto").innerText=""+n,e.total=o,r.innerText=n,document.querySelector(".boton-pagar").onclick=a}async function a(){const{id:t,nombre:o,productos:n,unidades:a,total:c}=e,r=new FormData,i=n.map(t=>t.id);r.append("idUsuario",t),r.append("productos",i),r.append("total",c);try{const t="/api/carrito",e=await fetch(t,{method:"POST",body:r});(await e.json()).resultado&&Swal.fire({icon:"success",title:"Compra Pagada",text:"Tu compra fue pagada correctamente",button:"OK"}).then(()=>{setTimeout(()=>{window.location.reload()},1e3)})}catch(t){Swal.fire({icon:"error",title:"Error",text:"Hubo un error al pagar"})}}document.addEventListener("DOMContentLoaded",(function(){o(),document.querySelectorAll(".tabs button").forEach(e=>{e.addEventListener("click",(function(e){t=parseInt(e.target.dataset.paso),o()}))}),async function(){try{const t="/api/productos",o=await fetch(t);(await o.json()).forEach(t=>{const{id:o,nombre:a,imagen:c,precio:r}=t,i=document.createElement("DIV");i.innerHTML=`<img class="producto-imagen" src="img/${c}" alt="Imagen playera"> `,i.classList.add("dise√±o-producto");const s=document.createElement("H3");s.classList.add("nombre-producto"),s.textContent=a;const d=document.createElement("P");d.classList.add("precio-producto"),d.textContent="$"+r;const l=document.createElement("DIV");l.innerHTML=`<a href="producto.php?id=${o}" class="boton-ver">Ver</a>`,l.classList.add("agregar");const u=document.createElement("BUTTON");u.classList.add("agregar-carrito"),u.classList.add("boton-agregar"),u.textContent="Agregar",u.dataset.idProducto=o,u.onclick=function(){!function(t){const{id:o}=t,{productos:a}=e;document.querySelector("#productos").addEventListener("click",(function(o){if(o.target.classList.contains("boton-agregar")){const c=o.target.parentElement.parentElement,r={id:t.id,quantity:1,title:c.querySelector("h3").textContent,price:c.querySelector("p").textContent};if(a.some(t=>t.id===r.id)){const t=e.productos.map(t=>t.id===r.id?(t.quantity++,t):t);e.productos=[...t]}else e.productos=[...a,r];n()}})),document.querySelector(".lista-carrito").addEventListener("click",(function(t){if(t.target.classList.contains("boton-eliminar")){const o=t.target.parentElement.parentElement.querySelector(".producto-id").textContent;e.productos=e.productos.filter(t=>t.id!==o),n()}}))}(t),Swal.fire({position:"top-end",icon:"success",title:"Agregado Correctamente",showConfirmButton:!1,timer:1500})},l.appendChild(u);const p=document.createElement("DIV");p.classList.add("publicidad"),p.appendChild(i),p.appendChild(s),p.appendChild(d),p.appendChild(l),document.querySelector("#productos").appendChild(p)})}catch(t){console.log(t)}}(),e.nombre=document.querySelector("#nombre-cliente-js").textContent,e.id=document.querySelector(".id-cliente").textContent}))})();
//# sourceMappingURL=main.js.map
